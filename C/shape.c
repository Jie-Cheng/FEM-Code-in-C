#include "shape.h"


void ShapeFun(const int nen, double p[nen], const int nsd, double xi[nsd]) {
    if (nsd == 1) {
        if (nen == 2) {
            p[0] = 0.5 * ( 1.0 + xi[0]);
            p[1] = 0.5 * ( 1.0 - xi[0]);
        }
    } else if ( nsd == 2) {
        if (nen == 3) {
            p[0] = xi[0];
            p[1] = xi[1];
            p[2] = 1.0 - xi[0] - xi[1];
        } else if (nen == 4) {
            p[0] = 0.25 * (1.0 - xi[0]) * (1.0 - xi[1]);
            p[1] = 0.25 * (1.0 + xi[0]) * (1.0 - xi[1]);
            p[2] = 0.25 * (1.0 + xi[0]) * (1.0 + xi[1]);
            p[3] = 0.25 * (1.0 - xi[0]) * (1.0 + xi[1]);
        }
    } else if ( nsd == 3) {
        if (nen == 4) {
            p[0] = xi[0];
            p[1] = xi[2];
            p[2] = xi[1];
            p[3] = 1.0 - xi[0] - xi[1] - xi[2];
        } else if (nen == 8) {
            p[0] = (1.0 - xi[0]) * (1.0 - xi[1]) * (1.0 - xi[2])/8.0;
            p[1] = (1.0 + xi[0]) * (1.0 - xi[1]) * (1.0 - xi[2])/8.0;
            p[2] = (1.0 + xi[0]) * (1.0 + xi[1]) * (1.0 - xi[2])/8.0;
            p[3] = (1.0 - xi[0]) * (1.0 + xi[1]) * (1.0 - xi[2])/8.0;
            p[4] = (1.0 - xi[0]) * (1.0 - xi[1]) * (1.0 + xi[2])/8.0;
            p[5] = (1.0 + xi[0]) * (1.0 - xi[1]) * (1.0 + xi[2])/8.0;
            p[6] = (1.0 + xi[0]) * (1.0 + xi[1]) * (1.0 + xi[2])/8.0;
            p[7] = (1.0 - xi[0]) * (1.0 + xi[1]) * (1.0 + xi[2])/8.0;
        }
    }
}


void ShapeDer(const int nsd, const int nen, double p[nsd][nen], double xi[nsd]) {
    if (nsd == 1) {
        if (nen == 2) {
            p[0][0] = 0.5;
            p[0][1] = -0.5;
        }
    } else if (nsd == 2) {
        if (nen == 3) {
            p[0][0] = 1.0;
            p[0][1] = 0.0;
            p[0][2] = -1.0;
            p[1][0] = 0.0;
            p[1][1] = 1.0;
            p[1][2] = -1.0;
        } else if (nen == 4) {
            p[0][0] = -0.25 * (1.0 - xi[1]);
            p[0][1] = 0.25 * (1.0 - xi[1]);
            p[0][2] = 0.25 * (1.0 + xi[1]);
            p[0][3] = -0.25 * (1.0 - xi[1]);
            p[1][0] = -0.25 * (1.0 - xi[0]);
            p[1][1] = -0.25 * (1.0 + xi[0]);
            p[1][2] = 0.25 * (1.0 + xi[0]);
            p[1][3] = 0.25 * (1.0 - xi[0]);
        }
    } else if (nsd == 3) {
        if (nen == 4) {
            p[0][0] = 1.0;
            p[0][1] = 0.0;
            p[0][2] = 0.0;
            p[0][3] = -1.0;
            p[1][0] = 0.0;
            p[1][1] = 0.0;
            p[1][2] = 1.0;
            p[1][3] = -1.0;
            p[2][0] = 0.0;
            p[2][1] = 1.0;
            p[2][2] = 0.0;
            p[2][3] = -1.0;
        } else if (nen == 8) {
            p[0][0] = -(1.0 - xi[1]) * (1.0 - xi[2])/8;
            p[0][1] = (1.0 - xi[1]) * (1.0 - xi[2])/8;
            p[0][2] = (1.0 +  xi[1]) * (1.0 - xi[2])/8;
            p[0][3] = -(1.0 + xi[1]) * (1.0 - xi[2])/8;
            p[0][4] = -(1.0 - xi[1]) * (1.0 + xi[2])/8;
            p[0][5] = (1.0 - xi[1]) * (1.0 + xi[2])/8;
            p[0][6] = (1.0 + xi[1]) * (1.0 + xi[2])/8;
            p[0][7] = -(1.0 + xi[1]) * (1.0 + xi[2])/8;
            p[1][0] = -(1.0 - xi[0]) * (1.0 - xi[2])/8;
            p[1][1] = -(1.0 + xi[0]) * (1.0 - xi[2])/8;
            p[1][2] = (1.0 + xi[0]) * (1.0 - xi[2])/8;
            p[1][3] = (1.0 - xi[0]) * (1.0 - xi[2])/8;
            p[1][4] = -(1.0 - xi[0]) * (1.0 + xi[2])/8;
            p[1][5] = -(1.0 + xi[0]) * (1.0 + xi[2])/8;
            p[1][6] = (1.0 + xi[0]) * (1.0 + xi[2])/8;
            p[1][7] = (1.0 - xi[0]) * (1.0 + xi[2])/8;
            p[2][0] = -(1.0 - xi[0]) * (1.0 - xi[1])/8;
            p[2][1] = -(1.0 - xi[0]) * (1.0 - xi[1])/8;
            p[2][2] = -(1.0 + xi[0]) * (1.0 + xi[1])/8;
            p[2][3] = -(1.0 - xi[0]) * (1.0 + xi[1])/8;
            p[2][4] = (1.0 - xi[0]) * (1.0 - xi[1])/8;
            p[2][5] = (1.0 + xi[0]) * (1.0 - xi[1])/8;
            p[2][6] = (1.0 + xi[0]) * (1.0 + xi[1])/8;
            p[2][7] = (1.0 - xi[1]) * (1.0 + xi[1])/8;
        }
    }
}
